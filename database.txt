CREATE DATABASE projedata_challenge;
USE projedata_challenge;

CREATE TABLE tb_product (
    p_code INTEGER AUTO_INCREMENT PRIMARY KEY,
    p_name VARCHAR(150) NOT NULL,
    p_value DECIMAL(10, 2) NOT NULL
);

CREATE TABLE tb_raw_material (
    rm_code INTEGER AUTO_INCREMENT PRIMARY KEY,
    rm_name VARCHAR(150) NOT NULL,
    rm_quantity INTEGER NOT NULL
);

CREATE TABLE tb_p_rm (
	id INT AUTO_INCREMENT PRIMARY KEY,
    p_code INT NOT NULL,
    rm_code INT NOT NULL,
    required_quantity INT NOT NULL,

    CONSTRAINT fk_product
		FOREIGN KEY (p_code) REFERENCES tb_product(p_code)
        ON DELETE CASCADE,

	CONSTRAINT fk_rm
		FOREIGN KEY (rm_code) REFERENCES tb_raw_material(rm_code)
        ON DELETE CASCADE,

	CONSTRAINT unique_product_material
		UNIQUE (p_code, rm_code)
);